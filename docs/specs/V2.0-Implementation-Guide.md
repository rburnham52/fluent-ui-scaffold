# Fluent UI Scaffold V2.0 Implementation Guide

## Overview

This guide provides step-by-step instructions for implementing the V2.0 specification. It includes concrete code examples and best practices for creating a truly framework-agnostic E2E testing library.

## Implementation Steps

### Step 1: Core Framework Interfaces

#### 1.1 IUIDriver Interface

```csharp
// src/FluentUIScaffold.Core/Interfaces/IUIDriver.cs
using System;

namespace FluentUIScaffold.Core.Interfaces
{
    /// <summary>
    /// Core interface for UI driver implementations that abstract underlying testing frameworks.
    /// </summary>
    public interface IUIDriver : IDisposable
    {
        /// <summary>
        /// Gets the current URL of the browser.
        /// </summary>
        Uri? CurrentUrl { get; }

        /// <summary>
        /// Clicks an element identified by the specified selector.
        /// </summary>
        /// <param name="selector">The CSS selector or other identifier for the element.</param>
        void Click(string selector);

        /// <summary>
        /// Types text into an element identified by the specified selector.
        /// </summary>
        /// <param name="selector">The CSS selector or other identifier for the element.</param>
        /// <param name="text">The text to type into the element.</param>
        void Type(string selector, string text);

        /// <summary>
        /// Selects an option from a dropdown element identified by the specified selector.
        /// </summary>
        /// <param name="selector">The CSS selector or other identifier for the dropdown element.</param>
        /// <param name="value">The value of the option to select.</param>
        void SelectOption(string selector, string value);

        /// <summary>
        /// Gets the text content of an element identified by the specified selector.
        /// </summary>
        /// <param name="selector">The CSS selector or other identifier for the element.</param>
        /// <returns>The text content of the element.</returns>
        string GetText(string selector);

        /// <summary>
        /// Checks if an element identified by the specified selector is visible.
        /// </summary>
        /// <param name="selector">The CSS selector or other identifier for the element.</param>
        /// <returns>True if the element is visible; otherwise, false.</returns>
        bool IsVisible(string selector);

        /// <summary>
        /// Checks if an element identified by the specified selector is enabled.
        /// </summary>
        /// <param name="selector">The CSS selector or other identifier for the element.</param>
        /// <returns>True if the element is enabled; otherwise, false.</returns>
        bool IsEnabled(string selector);

        /// <summary>
        /// Waits for an element identified by the specified selector to be present in the DOM.
        /// </summary>
        /// <param name="selector">The CSS selector or other identifier for the element.</param>
        void WaitForElement(string selector);

        /// <summary>
        /// Waits for an element identified by the specified selector to become visible.
        /// </summary>
        /// <param name="selector">The CSS selector or other identifier for the element.</param>
        void WaitForElementToBeVisible(string selector);

        /// <summary>
        /// Waits for an element identified by the specified selector to become hidden.
        /// </summary>
        /// <param name="selector">The CSS selector or other identifier for the element.</param>
        void WaitForElementToBeHidden(string selector);

        /// <summary>
        /// Navigates to the specified URL.
        /// </summary>
        /// <param name="url">The URL to navigate to.</param>
        void NavigateToUrl(Uri url);

        /// <summary>
        /// Gets the underlying framework-specific driver instance.
        /// </summary>
        /// <typeparam name="TDriver">The type of the framework-specific driver.</typeparam>
        /// <returns>The framework-specific driver instance.</returns>
        TDriver GetFrameworkDriver<TDriver>() where TDriver : class;
    }
}
```

#### 1.2 Plugin System Interface

```csharp
// src/FluentUIScaffold.Core/Interfaces/IUITestingFrameworkPlugin.cs
using Microsoft.Extensions.DependencyInjection;

namespace FluentUIScaffold.Core.Interfaces
{
    /// <summary>
    /// Interface for framework-specific plugins that provide driver implementations.
    /// </summary>
    public interface IUITestingFrameworkPlugin
    {
        /// <summary>
        /// Gets the name of the plugin.
        /// </summary>
        string Name { get; }

        /// <summary>
        /// Gets the version of the plugin.
        /// </summary>
        string Version { get; }

        /// <summary>
        /// Gets the driver type that this plugin provides.
        /// </summary>
        Type DriverType { get; }

        /// <summary>
        /// Configures the services for this plugin.
        /// </summary>
        /// <param name="services">The service collection.</param>
        /// <param name="options">The framework options.</param>
        void ConfigureServices(IServiceCollection services, FluentUIScaffoldOptions options);

        /// <summary>
        /// Creates a driver instance for this plugin.
        /// </summary>
        /// <param name="serviceProvider">The service provider.</param>
        /// <param name="options">The framework options.</param>
        /// <returns>The driver instance.</returns>
        IUIDriver CreateDriver(IServiceProvider serviceProvider, FluentUIScaffoldOptions options);
    }
}
```

### Step 2: Configuration Classes

#### 2.1 Core Options

```csharp
// src/FluentUIScaffold.Core/Configuration/FluentUIScaffoldOptions.cs
using Microsoft.Extensions.Logging;

namespace FluentUIScaffold.Core.Configuration
{
    /// <summary>
    /// Core configuration options for FluentUIScaffold.
    /// </summary>
    public class FluentUIScaffoldOptions
    {
        /// <summary>
        /// Gets or sets the base URL for the application.
        /// </summary>
        public Uri? BaseUrl { get; set; }

        /// <summary>
        /// Gets or sets the default timeout for operations.
        /// </summary>
public TimeSpan DefaultWaitTimeout { get; set; } = TimeSpan.FromSeconds(30);

        /// <summary>
        /// Gets or sets the default retry interval for operations.
        /// </summary>
        public TimeSpan DefaultRetryInterval { get; set; } = TimeSpan.FromMilliseconds(500);

        /// <summary>
        /// Gets or sets the default wait strategy.
        /// </summary>
        public WaitStrategy DefaultWaitStrategy { get; set; } = WaitStrategy.Smart;

        /// <summary>
        /// Gets or sets the page validation strategy.
        /// </summary>
        public PageValidationStrategy PageValidationStrategy { get; set; } = PageValidationStrategy.Configurable;

        /// <summary>
        /// Gets or sets the log level.
        /// </summary>
        public LogLevel LogLevel { get; set; } = LogLevel.Information;

        /// <summary>
        /// Gets or sets whether to capture screenshots on failure.
        /// </summary>
        public bool CaptureScreenshotsOnFailure { get; set; } = true;

        /// <summary>
        /// Gets or sets whether to capture DOM state on failure.
        /// </summary>
        public bool CaptureDOMStateOnFailure { get; set; } = true;

        /// <summary>
        /// Gets or sets the screenshot path.
        /// </summary>
        public string ScreenshotPath { get; set; } = "./screenshots";

        /// <summary>
        /// Gets or sets framework-specific options.
        /// </summary>
        public Dictionary<string, object> FrameworkSpecificOptions { get; set; } = new();
    }
}
```

#### 2.2 Options Builder

```csharp
// Build framework runtime options
var options = new FluentUIScaffoldOptionsBuilder()
    .WithBaseUrl(new Uri("https://localhost:5001"))
    .WithDefaultWaitTimeout(TimeSpan.FromSeconds(30))
    .WithHeadlessMode(false)
    .WithSlowMo(250)
    .Build();
```

### Step 3: Base Page Component

```csharp
// src/FluentUIScaffold.Core/Pages/BasePageComponent.cs
using FluentUIScaffold.Core.Configuration;
using FluentUIScaffold.Core.Interfaces;
using Microsoft.Extensions.DependencyInjection;
using Microsoft.Extensions.Logging;

namespace FluentUIScaffold.Core.Pages
{
    /// <summary>
/// Base class for all page components in the FluentUIScaffold framework.
/// </summary>
/// <typeparam name="TDriver">The driver type for this page component.</typeparam>
/// <typeparam name="TPage">The page type for maintaining fluent API context.</typeparam>
public abstract class BasePageComponent<TDriver, TPage> : IPageComponent<TDriver, TPage>
    where TDriver : class, IUIDriver
    where TPage : class, IPageComponent<TDriver, TPage>
    {
        /// <summary>
        /// Gets the driver instance.
        /// </summary>
        protected TDriver Driver { get; }

        /// <summary>
        /// Gets the service provider.
        /// </summary>
        protected IServiceProvider ServiceProvider { get; }

        /// <summary>
        /// Gets the logger.
        /// </summary>
        protected ILogger Logger { get; }

        /// <summary>
        /// Gets the options.
        /// </summary>
        protected FluentUIScaffoldOptions Options { get; }

        /// <summary>
        /// Gets the URL pattern for this page.
        /// </summary>
        public Uri UrlPattern { get; }

        /// <summary>
        /// Initializes a new instance of the <see cref="BasePageComponent{TDriver}"/> class.
        /// </summary>
        /// <param name="serviceProvider">The service provider.</param>
        /// <param name="urlPattern">The URL pattern for this page.</param>
        protected BasePageComponent(IServiceProvider serviceProvider, Uri urlPattern)
        {
            ServiceProvider = serviceProvider ?? throw new ArgumentNullException(nameof(serviceProvider));
                    Driver = serviceProvider.GetRequiredService<TDriver>();
        Logger = serviceProvider.GetRequiredService<ILogger<BasePageComponent<TDriver, TPage>>>();
            Options = serviceProvider.GetRequiredService<FluentUIScaffoldOptions>();
            
            UrlPattern = urlPattern;
            NavigateToUrl(urlPattern);
            ConfigureElements();
        }

        /// <summary>
        /// Called to configure page elements. Override in derived classes.
        /// </summary>
        protected abstract void ConfigureElements();

        /// <summary>
        /// Navigates to the specified URL.
        /// </summary>
        /// <param name="url">The URL to navigate to.</param>
        protected virtual void NavigateToUrl(Uri url)
        {
            Driver.NavigateToUrl(url);
        }

        /// <summary>
        /// Clicks an element.
        /// </summary>
        /// <param name="selector">The element selector.</param>
        protected virtual void ClickElement(string selector)
        {
            Driver.Click(selector);
        }

        /// <summary>
        /// Types text into an element.
        /// </summary>
        /// <param name="selector">The element selector.</param>
        /// <param name="text">The text to type.</param>
        protected virtual void TypeText(string selector, string text)
        {
            Driver.Type(selector, text);
        }

        /// <summary>
        /// Selects an option from a dropdown.
        /// </summary>
        /// <param name="selector">The dropdown selector.</param>
        /// <param name="value">The option value.</param>
        protected virtual void SelectOption(string selector, string value)
        {
            Driver.SelectOption(selector, value);
        }

        /// <summary>
        /// Gets the text of an element.
        /// </summary>
        /// <param name="selector">The element selector.</param>
        /// <returns>The element text.</returns>
        protected virtual string GetElementText(string selector)
        {
            return Driver.GetText(selector);
        }

        /// <summary>
        /// Checks if an element is visible.
        /// </summary>
        /// <param name="selector">The element selector.</param>
        /// <returns>True if the element is visible; otherwise, false.</returns>
        protected virtual bool IsElementVisible(string selector)
        {
            return Driver.IsVisible(selector);
        }

        /// <summary>
        /// Waits for an element to be present.
        /// </summary>
        /// <param name="selector">The element selector.</param>
        protected virtual void WaitForElement(string selector)
        {
            Driver.WaitForElement(selector);
        }

            /// <summary>
    /// Navigates to a target page component.
    /// </summary>
    /// <typeparam name="TTarget">The target page component type.</typeparam>
    /// <returns>The target page component instance.</returns>
    public virtual TTarget NavigateTo<TTarget>() where TTarget : BasePageComponent<TDriver, TTarget>
    {
        var targetPage = ServiceProvider.GetRequiredService<TTarget>();
        return targetPage;
    }

            /// <summary>
    /// Gets the framework-specific driver instance.
    /// </summary>
    protected TDriver Driver { get; private set; }
    
    /// <summary>
    /// Verifies the page title and returns the page instance for fluent API.
    /// </summary>
    /// <param name="title">The expected page title.</param>
    /// <returns>The current page instance.</returns>
    public virtual TPage VerifyPageTitle(string title)
    {
        if (string.IsNullOrEmpty(title))
            throw new ArgumentException("Title cannot be null or empty.", nameof(title));

        var pageTitle = Driver.GetPageTitle();
        if (!pageTitle.Equals(title, StringComparison.OrdinalIgnoreCase))
        {
            throw new ElementValidationException($"Expected page title '{title}', but got '{pageTitle}'.");
        }

        return (TPage)this;
    }
    
    /// <summary>
    /// Waits for an element and returns the page instance for fluent API.
    /// </summary>
    /// <param name="selector">The element selector.</param>
    /// <returns>The current page instance.</returns>
    public virtual TPage WaitForElement(string selector)
    {
        Driver.WaitForElement(selector);
        return (TPage)this;
    }
    
    /// <summary>
    /// Waits for an element to be visible and returns the page instance for fluent API.
    /// </summary>
    /// <param name="selector">The element selector.</param>
    /// <returns>The current page instance.</returns>
    public virtual TPage WaitForElementToBeVisible(string selector)
    {
        Driver.WaitForElementToBeVisible(selector);
        return (TPage)this;
    }

        /// <summary>
        /// Gets the page-aware verification context.
        /// </summary>
        public IVerificationContext<TPage> Verify => new VerificationContext<TPage>(Driver, Options, Logger, (TPage)(object)this);

        /// <summary>
        /// Creates an element with the specified selector.
        /// </summary>
        /// <param name="selector">The element selector.</param>
        /// <returns>An element builder for fluent configuration.</returns>
        protected ElementBuilder Element(string selector)
        {
            return new ElementBuilder(selector, Driver, Options);
        }
    }
}
```

### Step 4: App Initialization and Plugin Registration

```csharp
// Build framework options
var options = new FluentUIScaffoldOptionsBuilder()
    .WithBaseUrl(new Uri("https://localhost:5001"))
    .WithHeadlessMode(false)
    .WithSlowMo(250)
    .Build();

// Register the Playwright plugin explicitly
FluentUIScaffold.Playwright.FluentUIScaffoldPlaywrightBuilder.UsePlaywright();

// Create the app
var app = new FluentUIScaffoldApp<WebApp>(options);
```

### Step 5: Framework Plugin Implementation

#### 5.1 Playwright Plugin

```csharp
// src/FluentUIScaffold.Playwright/PlaywrightPlugin.cs
using FluentUIScaffold.Core.Configuration;
using FluentUIScaffold.Core.Interfaces;
using Microsoft.Extensions.DependencyInjection;

namespace FluentUIScaffold.Playwright
{
    /// <summary>
    /// Playwright plugin for FluentUIScaffold.
    /// </summary>
    public class PlaywrightPlugin : IUITestingFrameworkPlugin
    {
        /// <summary>
        /// Gets the name of the plugin.
        /// </summary>
        public string Name => "Playwright";

        /// <summary>
        /// Gets the version of the plugin.
        /// </summary>
        public string Version => "2.0.0";

        /// <summary>
        /// Gets the driver type that this plugin provides.
        /// </summary>
        public Type DriverType => typeof(PlaywrightDriver);

        /// <summary>
        /// Configures the services for this plugin.
        /// </summary>
        /// <param name="services">The service collection.</param>
        /// <param name="options">The framework options.</param>
        public void ConfigureServices(IServiceCollection services, FluentUIScaffoldOptions options)
        {
            services.AddSingleton<PlaywrightOptions>(provider =>
            {
                var frameworkOptions = provider.GetService<FrameworkOptions>() as PlaywrightOptions;
                return frameworkOptions ?? new PlaywrightOptions();
            });

            services.AddSingleton<IUIDriver, PlaywrightDriver>();
            services.AddSingleton<PlaywrightDriver>();
        }

        /// <summary>
        /// Creates a driver instance for this plugin.
        /// </summary>
        /// <param name="serviceProvider">The service provider.</param>
        /// <param name="options">The framework options.</param>
        /// <returns>The driver instance.</returns>
        public IUIDriver CreateDriver(IServiceProvider serviceProvider, FluentUIScaffoldOptions options)
        {
            var playwrightOptions = serviceProvider.GetRequiredService<PlaywrightOptions>();
            return new PlaywrightDriver(playwrightOptions);
        }
    }
}
```

#### 5.2 Playwright Driver

```csharp
// src/FluentUIScaffold.Playwright/PlaywrightDriver.cs
using FluentUIScaffold.Core.Configuration;
using FluentUIScaffold.Core.Interfaces;
using Microsoft.Playwright;

namespace FluentUIScaffold.Playwright
{
    /// <summary>
    /// Playwright implementation of IUIDriver.
    /// </summary>
    public class PlaywrightDriver : IUIDriver
    {
        private readonly PlaywrightOptions _options;
        private IPlaywright? _playwright;
        private IBrowser? _browser;
        private IBrowserContext? _context;
        private IPage? _page;

        /// <summary>
        /// Initializes a new instance of the <see cref="PlaywrightDriver"/> class.
        /// </summary>
        /// <param name="options">The Playwright options.</param>
        public PlaywrightDriver(PlaywrightOptions options)
        {
            _options = options ?? throw new ArgumentNullException(nameof(options));
        }

        /// <summary>
        /// Gets the current URL.
        /// </summary>
        public Uri? CurrentUrl => _page?.Url != null ? new Uri(_page.Url) : null;

        /// <summary>
        /// Initializes the driver.
        /// </summary>
        public async Task InitializeAsync()
        {
            _playwright = await Playwright.CreateAsync();
            _browser = await _playwright.Chromium.LaunchAsync(new BrowserTypeLaunchOptions
            {
                Headless = _options.Headless,
                SlowMo = _options.SlowMo
            });

            _context = await _browser.NewContextAsync(new BrowserNewContextOptions
            {
                ViewportSize = new ViewportSize
                {
                    Width = _options.ViewportWidth,
                    Height = _options.ViewportHeight
                }
            });

            _page = await _context.NewPageAsync();
        }

        /// <summary>
        /// Clicks an element.
        /// </summary>
        /// <param name="selector">The element selector.</param>
        public void Click(string selector)
        {
            _page?.ClickAsync(selector).Wait();
        }

        /// <summary>
        /// Types text into an element.
        /// </summary>
        /// <param name="selector">The element selector.</param>
        /// <param name="text">The text to type.</param>
        public void Type(string selector, string text)
        {
            _page?.FillAsync(selector, text).Wait();
        }

        /// <summary>
        /// Selects an option from a dropdown.
        /// </summary>
        /// <param name="selector">The dropdown selector.</param>
        /// <param name="value">The option value.</param>
        public void SelectOption(string selector, string value)
        {
            _page?.SelectOptionAsync(selector, value).Wait();
        }

        /// <summary>
        /// Gets the text of an element.
        /// </summary>
        /// <param name="selector">The element selector.</param>
        /// <returns>The element text.</returns>
        public string GetText(string selector)
        {
            return _page?.TextContentAsync(selector).Result ?? string.Empty;
        }

        /// <summary>
        /// Checks if an element is visible.
        /// </summary>
        /// <param name="selector">The element selector.</param>
        /// <returns>True if the element is visible; otherwise, false.</returns>
        public bool IsVisible(string selector)
        {
            return _page?.IsVisibleAsync(selector).Result ?? false;
        }

        /// <summary>
        /// Checks if an element is enabled.
        /// </summary>
        /// <param name="selector">The element selector.</param>
        /// <returns>True if the element is enabled; otherwise, false.</returns>
        public bool IsEnabled(string selector)
        {
            return _page?.IsEnabledAsync(selector).Result ?? false;
        }

        /// <summary>
        /// Waits for an element to be present.
        /// </summary>
        /// <param name="selector">The element selector.</param>
        public void WaitForElement(string selector)
        {
            _page?.WaitForSelectorAsync(selector, new PageWaitForSelectorOptions
            {
                Timeout = (float)_options.DefaultTimeout.TotalMilliseconds
            }).Wait();
        }

        /// <summary>
        /// Waits for an element to become visible.
        /// </summary>
        /// <param name="selector">The element selector.</param>
        public void WaitForElementToBeVisible(string selector)
        {
            _page?.WaitForSelectorAsync(selector, new PageWaitForSelectorOptions
            {
                State = WaitForSelectorState.Visible,
                Timeout = (float)_options.DefaultTimeout.TotalMilliseconds
            }).Wait();
        }

        /// <summary>
        /// Waits for an element to become hidden.
        /// </summary>
        /// <param name="selector">The element selector.</param>
        public void WaitForElementToBeHidden(string selector)
        {
            _page?.WaitForSelectorAsync(selector, new PageWaitForSelectorOptions
            {
                State = WaitForSelectorState.Hidden,
                Timeout = (float)_options.DefaultTimeout.TotalMilliseconds
            }).Wait();
        }

        /// <summary>
        /// Navigates to the specified URL.
        /// </summary>
        /// <param name="url">The URL to navigate to.</param>
        public void NavigateToUrl(Uri url)
        {
            _page?.GotoAsync(url.ToString()).Wait();
        }

        /// <summary>
        /// Gets the underlying framework-specific driver instance.
        /// </summary>
        /// <typeparam name="TDriver">The driver type.</typeparam>
        /// <returns>The driver instance.</returns>
        public TDriver GetFrameworkDriver<TDriver>() where TDriver : class
        {
            if (typeof(TDriver) == typeof(IPage))
                return _page as TDriver ?? throw new InvalidOperationException("Page is not initialized");
            
            if (typeof(TDriver) == typeof(IBrowser))
                return _browser as TDriver ?? throw new InvalidOperationException("Browser is not initialized");
            
            if (typeof(TDriver) == typeof(IBrowserContext))
                return _context as TDriver ?? throw new InvalidOperationException("Browser context is not initialized");
            
            throw new InvalidOperationException($"Unsupported driver type: {typeof(TDriver).Name}");
        }

        /// <summary>
        /// Disposes the driver.
        /// </summary>
        public void Dispose()
        {
            _page?.DisposeAsync().AsTask().Wait();
            _context?.DisposeAsync().AsTask().Wait();
            _browser?.DisposeAsync().AsTask().Wait();
            _playwright?.Dispose();
        }
    }
}
```

### Step 6: Page Component Implementation

```csharp
// samples/SampleApp.Tests/Pages/HomePage.cs
using FluentUIScaffold.Core.Pages;
using Microsoft.Extensions.DependencyInjection;

namespace SampleApp.Tests.Pages
{
    /// <summary>
/// Page object for the home page.
/// </summary>
public class HomePage : BasePageComponent<PlaywrightDriver, HomePage>
    {
        private IElement _counterButton;
        private IElement _counterText;
        private IElement _weatherDataElement;
        private IElement _navTodosButton;

        /// <summary>
        /// Initializes a new instance of the <see cref="HomePage"/> class.
        /// </summary>
        /// <param name="serviceProvider">The service provider.</param>
        public HomePage(IServiceProvider serviceProvider) 
            : base(serviceProvider, new Uri("/"))
        {
        }

        /// <summary>
        /// Configures the page elements.
        /// </summary>
        protected override void ConfigureElements()
        {
            _counterButton = Element(".counter-button")
                .WithDescription("Counter Button")
                .WithWaitStrategy(WaitStrategy.Clickable)
                .Build();

            _counterText = Element(".counter-text")
                .WithDescription("Counter Text")
                .WithWaitStrategy(WaitStrategy.Visible)
                .Build();

            _weatherDataElement = Element("[data-testid='weather-data']")
                .WithDescription("Weather Data Element")
                .WithWaitStrategy(WaitStrategy.Visible)
                .Build();

            _navTodosButton = Element("[data-testid='nav-todos']")
                .WithDescription("Todos Navigation Button")
                .WithWaitStrategy(WaitStrategy.Clickable)
                .Build();
        }

        /// <summary>
        /// Clicks the counter button.
        /// </summary>
        /// <returns>The current page instance.</returns>
        public HomePage ClickCounter()
        {
            ClickElement(_counterButton.Selector);
            return this;
        }

        /// <summary>
        /// Adds to the counter multiple times.
        /// </summary>
        /// <param name="count">The number of times to click.</param>
        /// <returns>The current page instance.</returns>
        public HomePage AddToCounter(int count)
        {
            for (int i = 0; i < count; i++)
            {
                ClickElement(_counterButton.Selector);
            }
            return this;
        }

        /// <summary>
        /// Verifies the counter value.
        /// </summary>
        /// <param name="expectedValue">The expected value.</param>
        /// <returns>The current page instance.</returns>
        public HomePage VerifyCounterValue(string expectedValue)
        {
            var actualValue = GetElementText(_counterText.Selector);
            if (actualValue != expectedValue)
            {
                throw new VerificationException($"Expected counter value '{expectedValue}', but got '{actualValue}'");
            }
            return this;
        }

        /// <summary>
        /// Waits for weather data to load.
        /// </summary>
        /// <returns>The current page instance.</returns>
        public HomePage WaitForWeatherData()
        {
            WaitForElement(_weatherDataElement.Selector);
            return this;
        }

        /// <summary>
        /// Example of using framework-specific features directly through the Driver property.
        /// </summary>
        public HomePage InterceptNetworkRequests()
        {
            // Direct access to framework-specific features
            Driver.InterceptNetworkRequests("/api/auth", response => {
                // Playwright-specific network interception
            });
            return this;
        }

        /// <summary>
        /// Navigates to the todos page.
        /// </summary>
        /// <returns>The todos page instance.</returns>
        public TodosPage NavigateToTodos()
        {
            ClickElement(_navTodosButton.Selector);
            return NavigateTo<TodosPage>();
        }

        /// <summary>
        /// Verifies the page title.
        /// </summary>
        /// <param name="expectedTitle">The expected title.</param>
        /// <returns>The current page instance.</returns>
        public HomePage VerifyPageTitle(string expectedTitle)
        {
            Verify.PageTitleContains(expectedTitle);
            return this;
        }
    }
}
```

### Step 7: Test Usage

```csharp
// samples/SampleApp.Tests/Examples/HomePageTests.cs
using FluentUIScaffold.Core;
using FluentUIScaffold.Core.Configuration;
using Microsoft.Extensions.Logging;
using Microsoft.VisualStudio.TestTools.UnitTesting;
using SampleApp.Tests.Pages;

namespace SampleApp.Tests.Examples
{
    /// <summary>
    /// Example tests for the home page.
    /// </summary>
    [TestClass]
    public class HomePageTests
    {
        private FluentUIScaffoldApp<WebApp> _fluentUI;

        /// <summary>
        /// Sets up the test.
        /// </summary>
        [TestInitialize]
        public void Setup()
        {
            _fluentUI = FluentUIScaffoldBuilder.Web<WebApp>(options =>
            {
                options.BaseUrl = new Uri("https://localhost:5001");
                options.LogLevel = LogLevel.Information;
                options.DefaultTimeout = TimeSpan.FromSeconds(30);
            }, frameworkOptions =>
            {
                var playwrightOptions = new PlaywrightOptions
                {
                    DefaultTimeout = TimeSpan.FromSeconds(30),
                    DefaultRetryInterval = TimeSpan.FromMilliseconds(500),
                    CaptureScreenshotsOnFailure = true,
                    Headless = false,
                    SlowMo = 1000
                };
                frameworkOptions.UsePlaywright(playwrightOptions);
            });
        }

        /// <summary>
        /// Tests that the counter can be clicked and verified.
        /// </summary>
        [TestMethod]
        public async Task Can_Click_Counter_And_Verify()
        {
            _fluentUI
                .NavigateTo<HomePage>()
                .VerifyPageTitle("FluentUIScaffold Sample App")
                .WaitForWeatherData()
                .ClickCounter()
                .VerifyCounterValue("1");
        }

        /// <summary>
        /// Tests that multiple counter clicks work correctly.
        /// </summary>
        [TestMethod]
        public async Task Can_Add_To_Counter_Multiple_Times()
        {
            _fluentUI
                .NavigateTo<HomePage>()
                .AddToCounter(3)
                .VerifyCounterValue("3");
        }

        /// <summary>
        /// Tests navigation to the todos page.
        /// </summary>
        [TestMethod]
        public async Task Can_Navigate_To_Todos_Page()
        {
            _fluentUI
                .NavigateTo<HomePage>()
                .NavigateToTodos()
                .Verify.ElementIsVisible("[data-testid='todos-list']");
        }

        /// <summary>
        /// Cleans up the test.
        /// </summary>
        [TestCleanup]
        public void Cleanup()
        {
            _fluentUI?.Dispose();
        }
    }
}
```

## Best Practices

### 1. Page Component Design

- Keep page components focused on a single page
- Use descriptive method names that reflect user actions
- Return the page instance for method chaining
- Use the verification context for assertions

### 2. Element Configuration

- Use data-testid attributes when possible
- Provide descriptive element descriptions
- Configure appropriate wait strategies
- Use meaningful selectors

### 3. Test Organization

- Group related tests in test classes
- Use descriptive test method names
- Keep tests focused and atomic
- Use setup and teardown methods appropriately

### 4. Framework Access

- Only use framework-specific features when necessary
- Encapsulate framework-specific code in page components
- Use the GetFramework method sparingly
- Document framework-specific usage

This implementation guide provides a complete foundation for the V2.0 specification. The key improvements include true framework agnosticism, dependency injection, explicit framework access, and a clean plugin architecture. 